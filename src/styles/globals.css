@import "tailwindcss";
@import "tailwindcss/preflight" layer(base);
@import "tailwindcss/utilities" layer(utilities);
@config "../../tailwind.config.mjs";

@layer base {
  :root {
    /* Main colors */
    --primary: #e13f5e;
    --primary-foreground: #ffffff;

    /* Light theme */
    --background: #ffffff;
    --foreground: #2c2d32;
    --card: #ffffff;
    --card-foreground: #2c2d32;
    --popover: #ffffff;
    --popover-foreground: #2c2d32;
    --muted: #f8f8f8;
    --muted-foreground: #636466;
    --accent: #f4f3f2;
    --accent-foreground: #2c2d32;
    --border: #ededed;
    --border-light: #e5e5e5;
    --input: #ededed;
    --ring: #e13f5e;
    --secondary: #303030;

    /* Common variables */
    --radius: 0.5rem;
    --container-max-width: 42rem;
    --header-height: 60px;
  }

  .dark {
    /* Dark theme */
    --background: #1e1e1e;
    --foreground: #e8e8e8;
    --card: #282828;
    --card-foreground: #e8e8e8;
    --popover: #282828;
    --popover-foreground: #e8e8e8;
    --muted: #202020;
    --muted-foreground: #9b9b9b;
    --accent: #303030;
    --accent-foreground: #e8e8e8;
    --border: #3d3d3d;
    --border-light: #2a2a2a;
    --input: #3d3d3d;
    --ring: #e13f5e;
    --secondary: #282828;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  html {
    @apply scroll-smooth overflow-x-hidden;
  }

  body {
    @apply bg-background text-foreground font-sans text-base antialiased overflow-x-hidden;
    font-family: 'Public Sans', sans-serif;
  }

  h1, h2, h3, h4, h5, h6 {
    @apply font-bold tracking-tight scroll-mt-20;
  }

  h1 {
    @apply text-3xl md:text-4xl;
  }

  h2 {
    @apply text-2xl md:text-3xl mt-8;
  }

  h3 {
    @apply text-xl md:text-2xl mt-8;
  }

  h4 {
    @apply text-lg md:text-xl mt-6;
  }

  img, video {
    @apply max-w-full;
  }
}

/* Custom components */
@layer components {
  /* Table of Contents styling */
  .table-of-contents {
    @apply text-sm my-4;
  }

  .table-of-contents ul {
    @apply pl-4 space-y-1;
  }

  .table-of-contents a {
    @apply text-muted-foreground hover:text-primary transition-colors no-underline block py-1 px-2 rounded;
  }

  .table-of-contents a:hover {
    @apply bg-muted;
  }

  .table-of-contents a.active {
    @apply text-primary font-medium relative;
  }

  .table-of-contents a.active::before {
    content: '';
    @apply absolute left-[-5px] top-1/2 -translate-y-1/2 w-[3px] h-[70%] bg-primary rounded-sm;
  }

  /* Heading level classes for TOC */
  .heading-level-1 {
    @apply text-foreground ml-0;
  }

  .heading-level-2 {
    @apply text-muted-foreground ml-4;
  }

  .heading-level-3 {
    @apply text-muted-foreground ml-8 text-[13px];
  }

  .heading-level-4,
  .heading-level-5,
  .heading-level-6 {
    @apply text-muted-foreground ml-12 text-[13px];
  }

  /* TOC indicator customization */
  .dark .toc-indicator {
    @apply bg-border;
  }

  .dark .toc-indicator.active {
    @apply bg-border-light;
  }

  .toc-indicator {
    @apply bg-border-light h-0.5 rounded-sm;
  }

  .toc-indicator.active {
    @apply bg-border;
  }

  /* Tags styling */
  .memo-tag {
    @apply inline-flex items-center rounded-md bg-muted px-2 py-1 text-sm font-medium text-muted-foreground hover:bg-muted/80;
  }

  /* Sidebar & Navigation */
  .sidebar-hover-indicator {
    @apply absolute left-1.5 top-1/2 -translate-y-1/2 bg-background text-primary w-6 h-6 rounded-full flex items-center justify-center border border-primary shadow-[0_0_5px_rgba(225,63,94,0.3)] transition-all z-20;
  }

  /* Mascots */
  .neko, .neko2 {
    @apply fixed z-10 pointer-events-none;
  }

  .neko {
    @apply bottom-4 right-4 w-24 h-auto max-w-[15vw];
  }

  .neko2 {
    @apply bottom-24 right-16 w-20 h-auto z-[5] max-w-[10vw];
  }

  /* Hide mascots when command palette is open */
  body.cmd-palette-open .neko,
  body.cmd-palette-open .neko2 {
    @apply opacity-0;
  }

  /* Yggdrasil tree background */
  .yggdrasil-tree {
    @apply absolute bottom-8 left-1/2 -translate-x-1/2 w-1/5 md:w-[20vw] max-w-xs object-contain opacity-[0.03] dark:opacity-10 -z-10 pointer-events-none;
  }

  /* Prose styling */
  .prose {
    @apply max-w-none;
  }

  .prose :where(h1, h2, h3, h4, h5, h6) {
    @apply font-bold;
  }

  .prose :where(pre) {
    @apply text-sm font-mono bg-muted border-none rounded-md overflow-x-auto w-full box-border p-4 mt-6 mb-6;
  }

  .prose :where(code):not(:where(pre) *) {
    @apply text-sm px-1 py-0.5 bg-muted font-mono rounded;
  }

  .prose :where(a) {
    @apply text-primary hover:underline;
  }

  .prose img {
    @apply rounded-md;
  }

  .prose table {
    @apply w-full border-collapse mt-6 mb-6;
  }

  .prose th, .prose td {
    @apply border p-3 align-top text-left;
  }

  .prose thead {
    @apply bg-muted sticky top-0 z-10;
  }

  .prose th {
    @apply font-medium;
  }

  /* Reading mode */
  .reading-mode .right-sidebar {
    @apply hidden lg:hidden;
  }

  /* Command palette customization */
  .command-palette {
    @apply relative;
  }

  .command-palette-container {
    @apply w-full max-w-2xl rounded-lg bg-white dark:bg-background border border-border shadow-lg overflow-hidden;
  }
  
  /* Command palette open state */
  body.cmd-palette-open {
    @apply overflow-hidden;
  }
}

/* Utilities */
@layer utilities {
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Animation utilities */
  .animate-fadeIn {
    animation: fadeIn 0.1s ease-in-out forwards;
  }

  .animate-slideUp {
    animation: slideUp 0.15s ease-out;
  }
}

/* Animations */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}
